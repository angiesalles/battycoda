{% load static %}
{% load django_vite %}

<!-- Include waveform player scripts -->
{% vite_asset 'static/js/player/index.js' %}

<script type="module">
    // Wait for Vite bundle to load, then initialize
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize waveform player for {{ container_id }}
        if (window.initWaveformPlayer) {
            window.initWaveformPlayer(
                "{{ container_id }}",
                {{ recording.id }},
                {{ allow_selection|yesno:"true,false" }},
                {{ show_zoom|yesno:"true,false" }},
                {% if segments %}{{ segments|safe }}{% else %}null{% endif %},
                {
                    waveformData: "{% url 'battycoda_app:recording_waveform_data' recording_id=recording.id %}",
                    spectrogramData: "{% url 'battycoda_app:get_spectrogram_data' recording_id=recording.id %}"
                }
            );
        }

        {% if spectrogram_info.status == 'available' %}
        {% include "recordings/includes/waveform_player/view_toggle.html" %}
        {% endif %}
    });
</script>