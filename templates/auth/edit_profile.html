{% extends 'base.html' %}

{% block title %}Edit Profile | BattyCoda{% endblock %}

{% block extra_css %}
<!-- Theme preview styles now in themes.css -->
{% endblock %}

{% block content %}
<div class="card shadow-sm">
    <div class="card-header bg-light">
        <h2 class="mb-0">Edit Profile</h2>
    </div>
    <div class="card-body">

    <div id="profile-form">
        {% csrf_token %}

        <div class="row mb-4">
            <div class="col-md-4 text-center">
                <div class="profile-image-container mb-3">
                    <div id="profile-image-display">
                        {% if profile.profile_image %}
                            <img src="{{ profile.profile_image.url }}?v={{ random }}" alt="Profile Image" class="img-fluid rounded-circle" style="width: 150px; height: 150px; object-fit: cover;">
                        {% else %}
                            <div class="profile-placeholder rounded-circle d-flex align-items-center justify-content-center bg-primary" style="width: 150px; height: 150px; margin: 0 auto;">
                                <span class="fas fa-user text-white" style="font-size: 4rem;"></span>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div class="mb-3">
                    <label for="profile_image_upload" class="form-label">Profile Image:</label>
                    <input type="file" name="profile_image" id="profile_image_upload" accept="image/*" class="form-control">
                    <small class="text-muted d-block mt-1">Select an image to update your profile picture</small>

                    <div class="mt-2">
                        <button type="button" id="upload-image-btn" class="btn btn-sm btn-primary">
                            <i class="fas fa-upload me-1"></i> Upload Image
                        </button>

                        {% if profile.profile_image %}
                            <button type="button" id="remove-image-btn" class="btn btn-sm btn-outline-danger ms-2">
                                <i class="fas fa-trash me-1"></i> Remove Image
                            </button>
                        {% endif %}
                    </div>

                    <div id="image-upload-status" class="mt-2"></div>
{% include "auth/includes/profile_image.html" %}
{% include "auth/includes/account_settings.html" %}
            </div>
        </div>

        <div id="form-status" class="mt-3"></div>
    </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{% load vite %}
<!-- Page data for profile module -->
<div id="profile-page-data"
     data-update-profile-url="{% url 'battycoda_app:update_profile_ajax' %}"
     hidden>
</div>

{% vite_asset 'static/js/profile/index.js' %}
{% endblock %}
